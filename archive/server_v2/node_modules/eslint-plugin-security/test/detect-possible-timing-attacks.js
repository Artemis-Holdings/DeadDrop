'use strict';

const RuleTester = require('eslint').RuleTester;
const tester = new RuleTester();

const ruleName = 'detect-possible-timing-attacks';
const Rule = require(`../rules/${ruleName}`);

const valid = 'if (age === 5) {}';
<<<<<<< HEAD
const invalidLeft = 'if (password === \'mypass\') {}';
const invalidRigth = 'if (\'mypass\' === password) {}';
=======
const invalidLeft = "if (password === 'mypass') {}";
const invalidRigth = "if ('mypass' === password) {}";
>>>>>>> e66b3631... init-tmn

// We only check with one string "password" and operator "==="
// to KISS.

tester.run(`${ruleName} (left side)`, Rule, {
  valid: [{ code: valid }],
  invalid: [
    {
      code: invalidLeft,
<<<<<<< HEAD
      errors: [{ message: 'Potential timing attack, left side: true' }]
    }
  ]
=======
      errors: [{ message: 'Potential timing attack, left side: true' }],
    },
  ],
>>>>>>> e66b3631... init-tmn
});

tester.run(`${ruleName} (right side)`, Rule, {
  valid: [{ code: valid }],
  invalid: [
    {
      code: invalidRigth,
<<<<<<< HEAD
      errors: [{ message: 'Potential timing attack, right side: true' }]
    }
  ]
=======
      errors: [{ message: 'Potential timing attack, right side: true' }],
    },
  ],
>>>>>>> e66b3631... init-tmn
});
